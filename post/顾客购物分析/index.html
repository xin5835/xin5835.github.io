<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>é¡¾å®¢è´­ç‰©åˆ†æ | Robert&#39;s Blog</title>
<meta name="keywords" content="Python">
<meta name="description" content="é¡¾å®¢è´­ç‰©æ•°æ®æ¸…æ´—ã€å¯è§†åŒ–å’Œèšç±»åˆ†æ.
å¯è§†åŒ–å›¾ç‰‡å’Œipybæ–‡ä»¶ï¼Œè¯¦è§! [Github] (https://github.com/xin5835/customer_shopping_analysis)">
<meta name="author" content="">
<link rel="canonical" href="https://xin5835.github.io/post/%E9%A1%BE%E5%AE%A2%E8%B4%AD%E7%89%A9%E5%88%86%E6%9E%90/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.0fda545bc7f33010c565fb31ec9554c9a3cb5d4d156363278c01c45e00735081.css" integrity="sha256-D9pUW8fzMBDFZfsx7JVUyaPLXU0VY2MnjAHEXgBzUIE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://xin5835.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://xin5835.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://xin5835.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://xin5835.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://xin5835.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://xin5835.github.io/post/%E9%A1%BE%E5%AE%A2%E8%B4%AD%E7%89%A9%E5%88%86%E6%9E%90/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css" integrity="sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js" integrity="sha384-Qsn9KnoKISj6dI8g7p1HBlNpVx0I8p1SvlwOldgi3IorMle61nQy4zEahWYtljaz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>

<meta property="og:url" content="https://xin5835.github.io/post/%E9%A1%BE%E5%AE%A2%E8%B4%AD%E7%89%A9%E5%88%86%E6%9E%90/">
  <meta property="og:site_name" content="Robert&#39;s Blog">
  <meta property="og:title" content="é¡¾å®¢è´­ç‰©åˆ†æ">
  <meta property="og:description" content="é¡¾å®¢è´­ç‰©æ•°æ®æ¸…æ´—ã€å¯è§†åŒ–å’Œèšç±»åˆ†æ.
å¯è§†åŒ–å›¾ç‰‡å’Œipybæ–‡ä»¶ï¼Œè¯¦è§! [Github] (https://github.com/xin5835/customer_shopping_analysis)">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2022-12-28T11:18:15+08:00">
    <meta property="article:modified_time" content="2022-12-28T11:18:15+08:00">
    <meta property="article:tag" content="Python">
    <meta property="og:image" content="https://xin5835.github.io/images/RepeatCustomer.jpeg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://xin5835.github.io/images/RepeatCustomer.jpeg">
<meta name="twitter:title" content="é¡¾å®¢è´­ç‰©åˆ†æ">
<meta name="twitter:description" content="é¡¾å®¢è´­ç‰©æ•°æ®æ¸…æ´—ã€å¯è§†åŒ–å’Œèšç±»åˆ†æ.
å¯è§†åŒ–å›¾ç‰‡å’Œipybæ–‡ä»¶ï¼Œè¯¦è§! [Github] (https://github.com/xin5835/customer_shopping_analysis)">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://xin5835.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "é¡¾å®¢è´­ç‰©åˆ†æ",
      "item": "https://xin5835.github.io/post/%E9%A1%BE%E5%AE%A2%E8%B4%AD%E7%89%A9%E5%88%86%E6%9E%90/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "é¡¾å®¢è´­ç‰©åˆ†æ",
  "name": "é¡¾å®¢è´­ç‰©åˆ†æ",
  "description": "é¡¾å®¢è´­ç‰©æ•°æ®æ¸…æ´—ã€å¯è§†åŒ–å’Œèšç±»åˆ†æ.\nå¯è§†åŒ–å›¾ç‰‡å’Œipybæ–‡ä»¶ï¼Œè¯¦è§! [Github] (https://github.com/xin5835/customer_shopping_analysis)\n",
  "keywords": [
    "Python"
  ],
  "articleBody": "é¡¾å®¢è´­ç‰©æ•°æ®æ¸…æ´—ã€å¯è§†åŒ–å’Œèšç±»åˆ†æ.\nå¯è§†åŒ–å›¾ç‰‡å’Œipybæ–‡ä»¶ï¼Œè¯¦è§! [Github] (https://github.com/xin5835/customer_shopping_analysis)\nå¯¼å…¥åº“\nimport numpy as np import pandas as pd import datetime from matplotlib import pyplot as plt import seaborn as sns plt.style.use(['fivethirtyeight']) from sklearn.preprocessing import LabelEncoder from sklearn.preprocessing import StandardScaler from sklearn import metrics from sklearn.decomposition import PCA from sklearn.cluster import KMeans from sklearn.cluster import AgglomerativeClustering from yellowbrick.cluster import KElbowVisualizer import warnings warnings.filterwarnings('ignore') åŠ è½½æ•°æ® data = pd.read_csv('/Users/robert/python/marketing_campaign.csv', sep= '\\t') data.info() data.head().T æ•°æ®å‡†å¤‡ æ•°æ®ç»´åº¦è¯´æ˜ åˆ†ç±» åˆ—å è¯´æ˜ ç”¨æˆ·å±æ€§ ID ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ç¬¦ ç”¨æˆ·å±æ€§ Year_Birth ç”¨æˆ·çš„å‡ºç”Ÿå¹´ä»½ ç”¨æˆ·å±æ€§ Education æ•™è‚²æ°´å¹³ ç”¨æˆ·å±æ€§ Marital_Status å©šå§»çŠ¶å†µ ç”¨æˆ·å±æ€§ Income å¹´å®¶åº­æ”¶å…¥ ç”¨æˆ·å±æ€§ Kidhome å„¿ç«¥æ•°é‡ ç”¨æˆ·å±æ€§ Teenhome é’å°‘å¹´äººæ•° ç”¨æˆ·å¥åº·åº¦ Dt_Customer é¡¾å®¢æ³¨å†Œçš„æ—¥æœŸ ç”¨æˆ·å¥åº·åº¦ Recency è‡ªç”¨æˆ·ä¸Šæ¬¡è´­ä¹°ä»¥æ¥çš„å¤©æ•° ç”¨æˆ·å¥åº·åº¦ NumWebVisitsMonth ä¸Šä¸ªæœˆè®¿é—®å…¬å¸ç½‘ç«™çš„æ¬¡æ•° ç”¨æˆ·å¥åº·åº¦ Complain å¦‚æœç”¨æˆ·åœ¨è¿‡å» 2 å¹´å†…æŠ•è¯‰ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 äº¤æ˜“ä¿¡æ¯ MntWines è¿‡å»ä¸¤å¹´åœ¨è‘¡è„é…’ä¸Šçš„æ¶ˆè´¹é‡‘é¢ äº¤æ˜“ä¿¡æ¯ MntFruits è¿‡å»ä¸¤å¹´åœ¨æ°´æœä¸Šçš„èŠ±è´¹ äº¤æ˜“ä¿¡æ¯ MntMeatProducts è¿‡å»2å¹´è‚‰ç±»æ¶ˆè´¹é‡ äº¤æ˜“ä¿¡æ¯ MntFishProducts è¿‡å»2å¹´åœ¨é±¼ä¸ŠèŠ±è´¹çš„é‡‘é¢ äº¤æ˜“ä¿¡æ¯ MntSweetProducts è¿‡å»2å¹´åœ¨ç³–æœä¸ŠèŠ±è´¹çš„é‡‘é¢ äº¤æ˜“ä¿¡æ¯ MntGoldProds è¿‡å»2å¹´åœ¨é»„é‡‘ä¸ŠèŠ±è´¹çš„é‡‘é¢ äº¤æ˜“æ¥æº NumWebPurchases é€šè¿‡å…¬å¸ç½‘ç«™è¿›è¡Œçš„è´­ä¹°æ•°é‡ äº¤æ˜“æ¥æº NumCatalogPurchases ä½¿ç”¨ç›®å½•è¿›è¡Œçš„è´­ä¹°æ•°é‡ äº¤æ˜“æ¥æº NumStorePurchases ç›´æ¥åœ¨å•†åº—è´­ä¹°çš„æ•°é‡ è¿è¥è½¬åŒ–ä¿¡æ¯ NumDealsPurchases æ‰“æŠ˜çš„è´­ä¹°æ¬¡æ•° è¿è¥è½¬åŒ–ä¿¡æ¯ AcceptedCmp1 å¦‚æœç”¨æˆ·åœ¨ç¬¬ä¸€ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 è¿è¥è½¬åŒ–ä¿¡æ¯ AcceptedCmp2 å¦‚æœç”¨æˆ·åœ¨ç¬¬äºŒä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 è¿è¥è½¬åŒ–ä¿¡æ¯ AcceptedCmp3 å¦‚æœç”¨æˆ·åœ¨ç¬¬ä¸‰ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 è¿è¥è½¬åŒ–ä¿¡æ¯ AcceptedCmp4 å¦‚æœç”¨æˆ·åœ¨ç¬¬ 4 ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 è¿è¥è½¬åŒ–ä¿¡æ¯ AcceptedCmp5 å¦‚æœç”¨æˆ·åœ¨ç¬¬ 5 ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 è¿è¥è½¬åŒ–ä¿¡æ¯ Response å¦‚æœç”¨æˆ·åœ¨ä¸Šæ¬¡æ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0 Z_CostContact Z_æˆæœ¬è”ç³»æ–¹å¼ Z_Revenue Z_æ”¶å…¥ ## æ£€æŸ¥ç¼ºå¤±å€¼ print(\"ç¼ºå¤±å€¼:\\n\", data.isnull().sum()) ## æ”¶å…¥æ•°æ®æœ‰ç¼ºå¤±å€¼ï¼Œç¼ºå¤±äº†24æ¡æ•°æ® ## æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤æ•°æ® data.duplicated().sum() åˆ†ææ€è·¯ï¼š ç›®æ ‡ï¼šæŒ–æ˜æ•°æ®çš„ä»·å€¼ï¼ŒåŠ©åŠ›ä¸šåŠ¡æˆé•¿å’Œç”¨æˆ·å¢é•¿ ç”¨æˆ·ä¿¡æ¯â€”-åšç”¨æˆ·ç”»åƒ ç”¨æˆ·å¥åº·åº¦â€”-åšç”¨æˆ·ä»·å€¼è¯„çº§ äº¤æ˜“ä¿¡æ¯â€“åšæ¨èç®—æ³• äº¤æ˜“æ¥æºâ€”-åšå¢é•¿åˆ†æ è¿è¥è½¬åŒ–â€”-è¯„ä¼°è¿è¥æ´»åŠ¨çš„æ•ˆæœ æ•°æ®æ¸…æ´— æ”¶å…¥æ•°æ®æœ‰24æ¡ç¼ºå¤±å€¼ï¼Œä½¿ç”¨å‡å€¼å¯¹å…¶è¿›è¡Œå¡«å…… é¡¾å®¢æ³¨å†Œæ—¶é—´éœ€è¦è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼ æ•™è‚²æ°´å¹³å’Œå©šå§»çŠ¶æ€ä¸¤ä¸ªå˜é‡éœ€è¦å¯¹å…¶è¿›è¡Œé‡æ–°ç¼–ç  ## é‡‡ç”¨å‡å€¼å¯¹æ”¶å…¥åˆ—çš„24æ¡ç¼ºå¤±æ•°æ®è¿›è¡Œå¡«å…… data = data.fillna(data['Income'].mean()) ## å°†æ³¨å†Œæ—¥æœŸæ•°æ®æ ¼å¼è°ƒæ•´ä¸ºæ—¥æœŸæ ¼å¼ data['Dt_Customer'] = pd.to_datetime(data['Dt_Customer']) data['Dt_Customer'].apply(['min', 'max']) print(\"å©šå§»çŠ¶å†µ:\\n\", data['Marital_Status'].value_counts(), '\\n') print(\"æ•™è‚²æƒ…å†µ:\\n\", data['Education'].value_counts()) ## ä¸åŒå©šå§»çŠ¶æ€çš„é¡¾å®¢æ‰€å æ¯”ä¾‹ plt.figure(figsize=(9, 9)) x = data['Marital_Status'].value_counts().sort_values() plt.pie(x=x, labels=['YoLo', 'Absurd','Alone', 'Window', 'Divorced', 'Single', 'Together','Married'], autopct = '%1.1f%%', ) plt.axis('equal') plt.title('Propotion of Marital_Status') ## ä¸åŒå—æ•™è‚²æ°´å¹³çš„é¡¾å®¢æ‰€å æ¯”ä¾‹ x = data['Education'].value_counts().sort_values() plt.figure(figsize=(9,9)) plt.pie(x=x, labels=['2n Cycle', 'Basic', 'Master', 'PhD', 'Graduation'], autopct = '%1.1f%%') plt.title('Propotion of Education') æ•°æ®é¢„å¤„ç† åˆ›å»ºæ–°çš„æ•°æ®ç‰¹å¾:\nåˆ©ç”¨å‡ºç”Ÿæ—¥æœŸåˆ›å»ºAgeï¼ˆå¹´é¾„ï¼‰åˆ— åˆ›å»ºSpentï¼ˆæ€»æ¶ˆè´¹ï¼‰åˆ— åˆ›å»ºChildrenï¼ˆå°å­©ï¼‰åˆ— åˆ›å»ºTotalAcceptedCmpï¼ˆæ¥å—æŠ¥ä»·æ¬¡æ•°åˆè®¡ï¼‰åˆ— åˆ›å»ºNumTotalPurchasesï¼ˆæ€»è´­ä¹°æ•°é‡ï¼‰åˆ— data['Age'] = data.apply(lambda data: 2015- data['Year_Birth'], axis=1) data['Spent'] = data.apply(lambda data: data['MntFishProducts'] + data['MntFruits'] + data['MntGoldProds'] + data['MntMeatProducts'] + data['MntSweetProducts'] + data['MntWines'], axis=1) data['Children'] = data.apply(lambda data: data['Kidhome'] + data['Teenhome'], axis=1) data['TotalAcceptedCmp'] = data.apply(lambda data: data['AcceptedCmp1'] + data['AcceptedCmp2'] + data['AcceptedCmp3'] + data['AcceptedCmp4'] + data['AcceptedCmp5'], axis=1) data['NumTotalPurchases'] = data.apply(lambda data: data['NumWebPurchases'] + data['NumCatalogPurchases'] + data['NumStorePurchases'] + data['NumDealsPurchases'], axis=1) ## åˆ é™¤'Year_Birth', 'Z_CostContact', 'Z_Revenue', 'Kidhome', 'Teenhome'åˆ— data = data.drop(['Year_Birth', 'Z_CostContact', 'Z_Revenue', 'Kidhome', 'Teenhome'], axis=1) ## åˆ é™¤æ•°æ®ä¸­æ”¶å…¥å’Œå¹´é¾„çš„å¼‚å¸¸å€¼éƒ¨åˆ† data = data.drop(data.loc[data['Income'] \u003e 600000].index) data = data.drop(data.loc[data['Age'] \u003e 100].index) æ•°æ®å¯è§†åŒ– ## åˆ›å»ºæ–°çš„ç‰¹å¾â€Have_Childrenâ€œï¼Œæœ‰å°å­©å€¼ä¸º1ï¼Œæ²¡æœ‰å°å­©å€¼ä¸º0 data['Have_Children'] = np.where(data.Children \u003e 0, 1, 0) data.head() ## ä»¥æ˜¯å¦æœ‰å°å­©ä¸ºåˆ†ç»„å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ç»˜åˆ¶æ•£ç‚¹å›¾çŸ©é˜µ pairplot = data.loc[:, ['Income', 'Age', 'Spent', 'Recency', 'Have_Children']] sns.pairplot(pairplot, hue='Have_Children', palette='Set1') ## å¯¹è¿ç»­å‹å˜é‡Ageè¿›è¡Œé¢å…ƒåˆ’åˆ† bins = [0, 20, 40, 60, 80,100] aged = pd.cut(data['Age'], bins=bins) print('number of age_cut:\\n', aged.value_counts()) ## ä¸åŒå¹´é¾„æ®µé¡¾å®¢åˆ†ç±»æ±‡æ€» plt.figure(figsize=(12,6)) sns.countplot(y=aged, palette='Set2') plt.title('countplot of Age') ## ä¸åŒå¹´é¾„åŒºé—´åœ¨è´­ç‰©èŠ±è´¹ä¸Šçš„åŒºåˆ« plt.figure(figsize=(12,6)) sns.boxplot(x=aged, y=data['Spent'], palette='Set2') ## å—æ•™è‚²æ°´å¹³å’Œè´­ç‰©èŠ±è´¹é—´çš„å…³ç³» ## ä¸åŒå©šå§»çŠ¶æ€ä¸‹é¡¾å®¢çš„èŠ±è´¹æ¯”è¾ƒ to_boxplot = ['Education', 'Marital_Status'] fig, axes = plt.subplots(2, 1, figsize=(12, 12)) axes = axes.flatten() for col, ax in zip(to_boxplot, axes): ax = sns.boxplot(data=data, x=col, y='Spent', ax=ax, palette='Set2') ax.set_title(f'boxplot of spent by {col}') ## ä»¥æ•™è‚²æ°´å¹³çš„ä¸åŒå¯¹ä¸åŒå©šå§»çŠ¶æ€çš„é¡¾å®¢è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¯¹æ¯”å…¶åœ¨æ”¶å…¥å’Œè´­ç‰©èŠ±è´¹ä¸Šçš„å·®å¼‚å¯¹æ¯” fig, axes = plt.subplots(2, 1, figsize=(14,10)) sns.barplot(x= 'Marital_Status',y='Income',hue='Education',data=data, ci=0,palette='Set2', ax=axes[0]) sns.barplot(x= 'Marital_Status',y='Spent',hue='Education',data=data, ci=0, palette='Set2', ax=axes[1]) ## æ”¶å…¥å’Œæ”¯å‡ºå‘ˆçº¿æ€§å¢é•¿å…³ç³» fig, axes = plt.subplots(1, 2, figsize=(14,6)) sns.scatterplot(y=data['Spent'], x=data['Income'], ax=axes[0]) sns.regplot(y='Spent', x='Income', data=data, ax=axes[1]) ## ç½‘ç«™é¡¾å®¢æ•´ä½“èŠ±è´¹ç›´æ–¹å›¾ plt.figure(figsize=(12,6)) sns.histplot(data['Spent'], bins=50, kde=True) plt.title('histogram of Spent') ## è‡ªç”¨æˆ·ä¸Šæ¬¡è´­ä¹°ä»¥æ¥çš„å¤©æ•°çš„é¢‘æ•°åˆ†å¸ƒ plt.figure(figsize=(12,6)) sns.histplot(data['Recency'], bins=60) ## ç½‘ç«™ç”¨æˆ·æœˆåº¦æ´»è·ƒé¢‘æ•°ç»Ÿè®¡ plt.figure(figsize=(12,6)) sns.histplot(data['NumWebVisitsMonth'], bins=50, kde=True) plt.title('Monthly activities (5-7)/month') ## ç½‘ç«™æŠ•è¯‰æƒ…å†µ x = data['Complain'].value_counts().sort_values() plt.figure(figsize=(8,8)) plt.pie(x=x, labels=['YES', 'NO'], autopct = '%1.1f%%') plt.title('Complain of customer') ## é…’ã€é±¼ã€æ°´æœã€é»„é‡‘ã€è‚‰ã€ç³–æœå„è‡ªé”€é‡é¢‘æ•°ç»Ÿè®¡ to_histplot = ['MntWines', 'MntFishProducts', 'MntFruits', 'MntGoldProds', 'MntMeatProducts', 'MntSweetProducts'] fig, axes = plt.subplots(3, 2, sharex=True, sharey=True, figsize=(14, 10)) axes = axes.flatten() for col, ax in zip(to_histplot, axes): ax = sns.histplot(data=data, x=col, ax=ax) ax.set_title(f'histogram of {col}') ## é€šè¿‡ç›®å½•ã€å•†åº—å’Œç½‘ç«™ä¸‰ä¸ªæ¸ é“è´­ä¹°çš„é¢‘æ•°ç»Ÿè®¡ to_histplot = ['NumCatalogPurchases', 'NumStorePurchases', 'NumWebPurchases'] fig, axes = plt.subplots(1, 3, sharey=True, figsize=(14, 9)) axes = axes.flatten() for col, ax in zip(to_histplot, axes): ax = sns.histplot(data=data, x=col, ax=ax) plt.subplots_adjust(hspace = 0.5, wspace = 0.3) ## åˆ›å»ºæ€»æ´»åŠ¨æ¥å—æŠ¥ä»·æ¬¡æ•°æŒ‡æ ‡ acceptedConcat = data[['AcceptedCmp1', 'AcceptedCmp2', 'AcceptedCmp3', 'AcceptedCmp4', 'AcceptedCmp5']] acceptedConcat = acceptedConcat.apply(pd.DataFrame.sum) print('acceptedConcat:\\n', acceptedConcat) ## æ¯æ¬¡æ¥å—æ´»åŠ¨æŠ¥ä»·çš„ç”¨æˆ·çš„é¢‘æ•°ç»Ÿè®¡ plt.figure(figsize=(12,6)) plt.title('accepted the campaings in every attempt') sns.barplot(x=acceptedConcat.index, y=acceptedConcat, palette='Set2') ## ç”¨æˆ·ä¸Šæ¬¡è´­ä¹°ä»¥æ¥çš„å¤©æ•°å’Œåœ¨ä¸Šæ¬¡æ´»åŠ¨æ˜¯å¦æ¥å—æŠ¥ä»·é—´çš„å…³ç³» plt.figure(figsize=(12,6)) plt.title('Recency Vs Acceptance of an offer') sns.lineplot(x='Recency', y='Response', data=data) ## ç½‘ç«™æ¯æœˆæ´»è·ƒç”¨æˆ·æŠ˜çº¿å›¾ groupedDate = data.set_index('Dt_Customer') groupedDate = groupedDate.resample('M').count() plt.figure(figsize=(14,4)) plt.title('Customer NumWebVisitsMonth by mounths') groupedDate.NumWebVisitsMonth.plot(kind='line') ## æ¯æœˆæ€»ä½“æ¶ˆè´¹é‡‘é¢æŠ˜çº¿å›¾ groupedDate = data.set_index('Dt_Customer') groupedDate = groupedDate.resample('M').count() plt.figure(figsize=(14,4)) plt.title('Customer Spent by mounths') groupedDate.Spent.plot(kind='line') ## æ¯æœˆé€šè¿‡ç½‘ç«™è´­ä¹°çš„ç”¨æˆ·æŠ˜çº¿å›¾ groupedDate = data.set_index('Dt_Customer') groupedDate = groupedDate.resample('M').count() plt.figure(figsize=(14,4)) plt.title('Customer NumWebPurchases by mounths') groupedDate.NumWebPurchases.plot() ## æ¯æœˆé€šè¿‡ç›®å½•è´­ä¹°çš„ç”¨æˆ·æŠ˜çº¿å›¾ groupedDate = data.set_index('Dt_Customer') groupedDate = groupedDate.resample('M').count() plt.figure(figsize=(14,4)) plt.title('Customer NumCatalogPurchases by mounths') groupedDate.NumCatalogPurchases.plot(kind='line') ##æ¯æœˆé€šè¿‡å•†åº—è´­ä¹°çš„ç”¨æˆ·æŠ˜ç°å›¾ groupedDate = data.set_index('Dt_Customer') groupedDate = groupedDate.resample('M').count() plt.figure(figsize=(14,4)) plt.title('Customer NumStorePurchases by mounths') groupedDate.NumStorePurchases.plot(kind='line') è‡ª2014å¹´6æœˆä»½ä»¥æ¥ç½‘ç«™çš„ç½‘ç«™è®¿é—®æ¬¡æ•°å’Œäº¤æ˜“æ€»é‡å‡ºç°äº†å¤§å¹…çš„ä¸‹æ»‘ã€‚é€šè¿‡ç½‘ç«™ã€ç›®å½•ã€å•†åº—ç›´æ¥è´­ä¹°çš„ä¸‰ä¸ªæ¸ é“éƒ½å‡ºç°äº†ç›¸åŒè½¨è¿¹çš„ä¸‹æ»‘ã€‚\næ•°æ®é¢„å¤„ç† s = (data.dtypes == 'object') object_cols = list(s[s].index) print(\"Categorical variables in the dataset:\", object_cols) LE=LabelEncoder() for i in object_cols: data[i]=data[[i]].apply(LE.fit_transform) ## ç›¸å…³æ€§çƒ­åŠ›å›¾ plt.figure( figsize = (14, 14)) data1 = data.iloc[:, 1:-1] sns.heatmap(data1.corr(), annot=True, cmap='Set2') ds = data.copy() cols_del = ['ID', 'AcceptedCmp3', 'AcceptedCmp4', 'AcceptedCmp5', 'AcceptedCmp1','AcceptedCmp2', 'Complain', 'Response', 'Have_Children', 'Dt_Customer', 'Children'] ds = ds.drop(cols_del, axis=1) ## æ•°æ®æ ‡å‡†åŒ– scaler = StandardScaler() scaler.fit(ds) scaled_ds = pd.DataFrame(scaler.transform(ds),columns= ds.columns ) PCAé™ç»´ pca = PCA(n_components=3) pca.fit(scaled_ds) PCA_ds = pd.DataFrame(pca.transform(scaled_ds), columns=([\"col1\",\"col2\", \"col3\"])) PCA_ds.describe().T x =PCA_ds[\"col1\"] y =PCA_ds[\"col2\"] z =PCA_ds[\"col3\"] ## é™ç»´åæ•°æ®å¯è§†åŒ– fig = plt.figure(figsize=(10,8)) ax = fig.add_subplot(111, projection=\"3d\") ax.scatter(x,y,z, marker=\"o\" ) ax.set_title(\"Data Visualization In The Reduced Dimension\") plt.show() èšç±» Elbow_M = KElbowVisualizer(KMeans(), k=10) Elbow_M.fit(PCA_ds) Elbow_M.show() AC = AgglomerativeClustering(n_clusters=4) ## æ‹Ÿåˆæ¨¡å‹å¹¶é¢„æµ‹èšç±» yhat_AC = AC.fit_predict(PCA_ds) PCA_ds[\"Clusters\"] = yhat_AC ## å°†èšç±»ç‰¹å¾æ·»åŠ åˆ°åŸå§‹æ•°æ® data[\"Clusters\"]= yhat_AC ## èšç±»ç»“æœå¯è§†åŒ– fig = plt.figure(figsize=(10,8)) ax = plt.subplot(111, projection='3d', label=\"bla\") ax.scatter(x, y, z, s=50, c=PCA_ds[\"Clusters\"], marker='o', cmap = 'Set2' ) ax.set_title(\"The Plot Of The Clusters\") plt.show() è¯„ä¼°æ¨¡å‹ ## èšç±»ç»“æœåˆ†å¸ƒå›¾ plt.figure(figsize=(12, 6)) pl = sns.countplot(x=data[\"Clusters\"], palette= 'Set2') pl.set_title(\"Distribution Of The Clusters\") plt.show() ## æŒ‰ç…§æ”¶å…¥å’Œæ”¯å‡ºå¯¹èšç±»ç»“æœè¿›è¡Œå¯è§†åŒ– plt.figure(figsize=(12, 6)) pl = sns.scatterplot(data = data,x=data[\"Spent\"], y=data[\"Income\"],hue=data[\"Clusters\"], palette= 'Set2') pl.set_title(\"Cluster's Profile Based On Income And Spent\") plt.legend() plt.show() æ”¶å…¥ä¸æ”¯å‡ºå›¾æ˜¾ç¤ºé›†ç¾¤æ¨¡å¼\nç¬¬ 0 ç»„ï¼šé«˜æ”¯å‡ºå’Œå¹³å‡æ”¶å…¥ ç¬¬ 1 ç»„ï¼šé«˜æ¶ˆè´¹å’Œé«˜æ”¶å…¥ ç¬¬ 2 ç»„ï¼šä½æ”¯å‡ºå’Œä½æ”¶å…¥ ç¬¬ 3 ç»„ï¼šé«˜æ”¯å‡ºå’Œä½æ”¶å…¥ plt.figure(figsize=(12,6)) sns.swarmplot(x=data[\"Clusters\"], y=data[\"Spent\"], alpha=0.9, palette= 'Set2' ) ## æŒ‰ç…§èšç±»ç»“æœå¯¹æ´»åŠ¨æ€»æ¥å—æƒ…å†µè¿›è¡Œå¯è§†åŒ– plt.figure(figsize=(12,6)) pl = sns.countplot(x=data[\"TotalAcceptedCmp\"],hue=data[\"Clusters\"], palette= 'Set2') pl.set_title(\"Count Of Promotion Accepted\") pl.set_xlabel(\"Number Of Total Accepted Promotions\") plt.show() ",
  "wordCount" : "906",
  "inLanguage": "en",
  "image":"https://xin5835.github.io/images/RepeatCustomer.jpeg","datePublished": "2022-12-28T11:18:15+08:00",
  "dateModified": "2022-12-28T11:18:15+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://xin5835.github.io/post/%E9%A1%BE%E5%AE%A2%E8%B4%AD%E7%89%A9%E5%88%86%E6%9E%90/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Robert's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://xin5835.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://xin5835.github.io/" accesskey="h" title="Robert&#39;s Blog (Alt + H)">Robert&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://xin5835.github.io/" title="ğŸ Home">
                    <span>ğŸ Home</span>
                </a>
            </li>
            <li>
                <a href="https://xin5835.github.io/archives/" title="ğŸ—‚Archives">
                    <span>ğŸ—‚Archives</span>
                </a>
            </li>
            <li>
                <a href="https://xin5835.github.io/search/" title="ğŸ”Search (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”Search</span>
                </a>
            </li>
            <li>
                <a href="https://xin5835.github.io/tags/" title="ğŸ”–Tags">
                    <span>ğŸ”–Tags</span>
                </a>
            </li>
            <li>
                <a href="https://xin5835.github.io/links/" title="ğŸ’ŒLinks">
                    <span>ğŸ’ŒLinks</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      é¡¾å®¢è´­ç‰©åˆ†æ
    </h1>
    <div class="post-meta"><span title='2022-12-28 11:18:15 +0800 CST'>December 28, 2022</span>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="https://xin5835.github.io/images/RepeatCustomer.jpeg" alt="">
        
</figure><aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e5%8a%a0%e8%bd%bd%e6%95%b0%e6%8d%ae" aria-label="åŠ è½½æ•°æ®">åŠ è½½æ•°æ®</a></li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e5%87%86%e5%a4%87" aria-label="æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</a></li>
                    <li>
                        <a href="#%e5%88%86%e6%9e%90%e6%80%9d%e8%b7%af" aria-label="åˆ†ææ€è·¯ï¼š">åˆ†ææ€è·¯ï¼š</a></li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e6%b8%85%e6%b4%97" aria-label="æ•°æ®æ¸…æ´—">æ•°æ®æ¸…æ´—</a></li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e9%a2%84%e5%a4%84%e7%90%86" aria-label="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</a><ul>
                            
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96" aria-label="æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e9%a2%84%e5%a4%84%e7%90%86-1" aria-label="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</a></li>
                    <li>
                        <a href="#pca%e9%99%8d%e7%bb%b4" aria-label="PCAé™ç»´">PCAé™ç»´</a></li>
                    <li>
                        <a href="#%e8%81%9a%e7%b1%bb" aria-label="èšç±»">èšç±»</a></li>
                    <li>
                        <a href="#%e8%af%84%e4%bc%b0%e6%a8%a1%e5%9e%8b" aria-label="è¯„ä¼°æ¨¡å‹">è¯„ä¼°æ¨¡å‹</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    
    document.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();
    
        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        if (elements.length > 0) {
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }
    
        
        const topLink = document.getElementById('top-link');
        if (topLink) {
            topLink.addEventListener('click', (event) => {
                
                event.preventDefault();
    
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    }, false);
    
    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);
    
    window.addEventListener('scroll', () => {
        
        const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
    
        
        if (scrollPosition === 0) {
            return;
        }
    
        
        if (elements && elements.length > 0) {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - scrollPosition) > 0 && 
                    (getOffsetTop(element) - scrollPosition) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement;
    
            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                const tocLink = document.querySelector(`.inner ul li a[href="#${id}"]`);
                if (element === activeElement){
                    tocLink.classList.add('active');
    
                    
                    const tocContainer = document.querySelector('.toc .inner');
                    const linkOffsetTop = tocLink.offsetTop;
                    const containerHeight = tocContainer.clientHeight;
                    const linkHeight = tocLink.clientHeight;
    
                    
                    const scrollPosition = linkOffsetTop - (containerHeight / 2) + (linkHeight / 2);
                    tocContainer.scrollTo({ top: scrollPosition, behavior: 'smooth' });
                } else {
                    tocLink.classList.remove('active');
                }
            });
        }
    }, false);
    
    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);
    
    function checkTocPosition() {
        const width = document.body.scrollWidth;
    
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }
    
    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
    
</script>

  <div class="post-content"><p>é¡¾å®¢è´­ç‰©æ•°æ®æ¸…æ´—ã€å¯è§†åŒ–å’Œèšç±»åˆ†æ.</p>
<p>å¯è§†åŒ–å›¾ç‰‡å’Œipybæ–‡ä»¶ï¼Œè¯¦è§! [Github] (<a href="https://github.com/xin5835/customer_shopping_analysis">https://github.com/xin5835/customer_shopping_analysis</a>)</p>
<p>å¯¼å…¥åº“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">datetime</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">AgglomerativeClustering</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">KElbowVisualizer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">warnings</span>
</span></span><span class="line"><span class="cl"><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="åŠ è½½æ•°æ®">åŠ è½½æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#åŠ è½½æ•°æ®">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/robert/python/marketing_campaign.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span> 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</span></span></code></pre></div><h2 id="æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®å‡†å¤‡">#</a></h2>
<ul>
<li>æ•°æ®ç»´åº¦è¯´æ˜</li>
</ul>
<table>
  <thead>
      <tr>
          <th>åˆ†ç±»</th>
          <th>åˆ—å</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>ID</td>
          <td>ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ç¬¦</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>Year_Birth</td>
          <td>ç”¨æˆ·çš„å‡ºç”Ÿå¹´ä»½</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>Education</td>
          <td>æ•™è‚²æ°´å¹³</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>Marital_Status</td>
          <td>å©šå§»çŠ¶å†µ</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>Income</td>
          <td>å¹´å®¶åº­æ”¶å…¥</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>Kidhome</td>
          <td>å„¿ç«¥æ•°é‡</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å±æ€§</td>
          <td>Teenhome</td>
          <td>é’å°‘å¹´äººæ•°</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å¥åº·åº¦</td>
          <td>Dt_Customer</td>
          <td>é¡¾å®¢æ³¨å†Œçš„æ—¥æœŸ</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å¥åº·åº¦</td>
          <td>Recency</td>
          <td>è‡ªç”¨æˆ·ä¸Šæ¬¡è´­ä¹°ä»¥æ¥çš„å¤©æ•°</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å¥åº·åº¦</td>
          <td>NumWebVisitsMonth</td>
          <td>ä¸Šä¸ªæœˆè®¿é—®å…¬å¸ç½‘ç«™çš„æ¬¡æ•°</td>
      </tr>
      <tr>
          <td>ç”¨æˆ·å¥åº·åº¦</td>
          <td>Complain</td>
          <td>å¦‚æœç”¨æˆ·åœ¨è¿‡å» 2 å¹´å†…æŠ•è¯‰ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td>äº¤æ˜“ä¿¡æ¯</td>
          <td>MntWines</td>
          <td>è¿‡å»ä¸¤å¹´åœ¨è‘¡è„é…’ä¸Šçš„æ¶ˆè´¹é‡‘é¢</td>
      </tr>
      <tr>
          <td>äº¤æ˜“ä¿¡æ¯</td>
          <td>MntFruits</td>
          <td>è¿‡å»ä¸¤å¹´åœ¨æ°´æœä¸Šçš„èŠ±è´¹</td>
      </tr>
      <tr>
          <td>äº¤æ˜“ä¿¡æ¯</td>
          <td>MntMeatProducts</td>
          <td>è¿‡å»2å¹´è‚‰ç±»æ¶ˆè´¹é‡</td>
      </tr>
      <tr>
          <td>äº¤æ˜“ä¿¡æ¯</td>
          <td>MntFishProducts</td>
          <td>è¿‡å»2å¹´åœ¨é±¼ä¸ŠèŠ±è´¹çš„é‡‘é¢</td>
      </tr>
      <tr>
          <td>äº¤æ˜“ä¿¡æ¯</td>
          <td>MntSweetProducts</td>
          <td>è¿‡å»2å¹´åœ¨ç³–æœä¸ŠèŠ±è´¹çš„é‡‘é¢</td>
      </tr>
      <tr>
          <td>äº¤æ˜“ä¿¡æ¯</td>
          <td>MntGoldProds</td>
          <td>è¿‡å»2å¹´åœ¨é»„é‡‘ä¸ŠèŠ±è´¹çš„é‡‘é¢</td>
      </tr>
      <tr>
          <td>äº¤æ˜“æ¥æº</td>
          <td>NumWebPurchases</td>
          <td>é€šè¿‡å…¬å¸ç½‘ç«™è¿›è¡Œçš„è´­ä¹°æ•°é‡</td>
      </tr>
      <tr>
          <td>äº¤æ˜“æ¥æº</td>
          <td>NumCatalogPurchases</td>
          <td>ä½¿ç”¨ç›®å½•è¿›è¡Œçš„è´­ä¹°æ•°é‡</td>
      </tr>
      <tr>
          <td>äº¤æ˜“æ¥æº</td>
          <td>NumStorePurchases</td>
          <td>ç›´æ¥åœ¨å•†åº—è´­ä¹°çš„æ•°é‡</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>NumDealsPurchases</td>
          <td>æ‰“æŠ˜çš„è´­ä¹°æ¬¡æ•°</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>AcceptedCmp1</td>
          <td>å¦‚æœç”¨æˆ·åœ¨ç¬¬ä¸€ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>AcceptedCmp2</td>
          <td>å¦‚æœç”¨æˆ·åœ¨ç¬¬äºŒä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>AcceptedCmp3</td>
          <td>å¦‚æœç”¨æˆ·åœ¨ç¬¬ä¸‰ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>AcceptedCmp4</td>
          <td>å¦‚æœç”¨æˆ·åœ¨ç¬¬ 4 ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>AcceptedCmp5</td>
          <td>å¦‚æœç”¨æˆ·åœ¨ç¬¬ 5 ä¸ªæ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td>è¿è¥è½¬åŒ–ä¿¡æ¯</td>
          <td>Response</td>
          <td>å¦‚æœç”¨æˆ·åœ¨ä¸Šæ¬¡æ´»åŠ¨ä¸­æ¥å—äº†æŠ¥ä»·ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td>
      </tr>
      <tr>
          <td></td>
          <td>Z_CostContact</td>
          <td>Z_æˆæœ¬è”ç³»æ–¹å¼</td>
      </tr>
      <tr>
          <td></td>
          <td>Z_Revenue</td>
          <td>Z_æ”¶å…¥</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ£€æŸ¥ç¼ºå¤±å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¼ºå¤±å€¼:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>    <span class="c1">## æ”¶å…¥æ•°æ®æœ‰ç¼ºå¤±å€¼ï¼Œç¼ºå¤±äº†24æ¡æ•°æ®</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="åˆ†ææ€è·¯">åˆ†ææ€è·¯ï¼š<a hidden class="anchor" aria-hidden="true" href="#åˆ†ææ€è·¯">#</a></h2>
<ul>
<li>ç›®æ ‡ï¼šæŒ–æ˜æ•°æ®çš„ä»·å€¼ï¼ŒåŠ©åŠ›ä¸šåŠ¡æˆé•¿å’Œç”¨æˆ·å¢é•¿</li>
<li>ç”¨æˆ·ä¿¡æ¯&mdash;-åšç”¨æˆ·ç”»åƒ</li>
<li>ç”¨æˆ·å¥åº·åº¦&mdash;-åšç”¨æˆ·ä»·å€¼è¯„çº§</li>
<li>äº¤æ˜“ä¿¡æ¯&ndash;åšæ¨èç®—æ³•</li>
<li>äº¤æ˜“æ¥æº&mdash;-åšå¢é•¿åˆ†æ</li>
<li>è¿è¥è½¬åŒ–&mdash;-è¯„ä¼°è¿è¥æ´»åŠ¨çš„æ•ˆæœ</li>
</ul>
<h2 id="æ•°æ®æ¸…æ´—">æ•°æ®æ¸…æ´—<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®æ¸…æ´—">#</a></h2>
<ul>
<li>æ”¶å…¥æ•°æ®æœ‰24æ¡ç¼ºå¤±å€¼ï¼Œä½¿ç”¨å‡å€¼å¯¹å…¶è¿›è¡Œå¡«å……</li>
<li>é¡¾å®¢æ³¨å†Œæ—¶é—´éœ€è¦è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼</li>
<li>æ•™è‚²æ°´å¹³å’Œå©šå§»çŠ¶æ€ä¸¤ä¸ªå˜é‡éœ€è¦å¯¹å…¶è¿›è¡Œé‡æ–°ç¼–ç </li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## é‡‡ç”¨å‡å€¼å¯¹æ”¶å…¥åˆ—çš„24æ¡ç¼ºå¤±æ•°æ®è¿›è¡Œå¡«å……</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## å°†æ³¨å†Œæ—¥æœŸæ•°æ®æ ¼å¼è°ƒæ•´ä¸ºæ—¥æœŸæ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">])</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å©šå§»çŠ¶å†µ:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Marital_Status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ•™è‚²æƒ…å†µ:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ä¸åŒå©šå§»çŠ¶æ€çš„é¡¾å®¢æ‰€å æ¯”ä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Marital_Status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;YoLo&#39;</span><span class="p">,</span> <span class="s1">&#39;Absurd&#39;</span><span class="p">,</span><span class="s1">&#39;Alone&#39;</span><span class="p">,</span> <span class="s1">&#39;Window&#39;</span><span class="p">,</span> <span class="s1">&#39;Divorced&#39;</span><span class="p">,</span> <span class="s1">&#39;Single&#39;</span><span class="p">,</span> <span class="s1">&#39;Together&#39;</span><span class="p">,</span><span class="s1">&#39;Married&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="n">autopct</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Propotion of Marital_Status&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ä¸åŒå—æ•™è‚²æ°´å¹³çš„é¡¾å®¢æ‰€å æ¯”ä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;2n Cycle&#39;</span><span class="p">,</span> <span class="s1">&#39;Basic&#39;</span><span class="p">,</span> <span class="s1">&#39;Master&#39;</span><span class="p">,</span> <span class="s1">&#39;PhD&#39;</span><span class="p">,</span> <span class="s1">&#39;Graduation&#39;</span><span class="p">],</span> <span class="n">autopct</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Propotion of Education&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®é¢„å¤„ç†">#</a></h2>
<p><strong>åˆ›å»ºæ–°çš„æ•°æ®ç‰¹å¾:</strong></p>
<ul>
<li>åˆ©ç”¨å‡ºç”Ÿæ—¥æœŸåˆ›å»ºAgeï¼ˆå¹´é¾„ï¼‰åˆ—</li>
<li>åˆ›å»ºSpentï¼ˆæ€»æ¶ˆè´¹ï¼‰åˆ—</li>
<li>åˆ›å»ºChildrenï¼ˆå°å­©ï¼‰åˆ—</li>
<li>åˆ›å»ºTotalAcceptedCmpï¼ˆæ¥å—æŠ¥ä»·æ¬¡æ•°åˆè®¡ï¼‰åˆ—</li>
<li>åˆ›å»ºNumTotalPurchasesï¼ˆæ€»è´­ä¹°æ•°é‡ï¼‰åˆ—</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span>  <span class="mi">2015</span><span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Year_Birth&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Spent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MntFishProducts&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MntFruits&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MntGoldProds&#39;</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MntMeatProducts&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MntSweetProducts&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MntWines&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Children&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Kidhome&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Teenhome&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TotalAcceptedCmp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AcceptedCmp1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AcceptedCmp2&#39;</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">                                      <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AcceptedCmp3&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AcceptedCmp4&#39;</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">                                      <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AcceptedCmp5&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;NumTotalPurchases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NumWebPurchases&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NumCatalogPurchases&#39;</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">                            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NumStorePurchases&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NumDealsPurchases&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## åˆ é™¤&#39;Year_Birth&#39;, &#39;Z_CostContact&#39;, &#39;Z_Revenue&#39;, &#39;Kidhome&#39;, &#39;Teenhome&#39;åˆ—</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Year_Birth&#39;</span><span class="p">,</span> <span class="s1">&#39;Z_CostContact&#39;</span><span class="p">,</span> <span class="s1">&#39;Z_Revenue&#39;</span><span class="p">,</span> <span class="s1">&#39;Kidhome&#39;</span><span class="p">,</span> <span class="s1">&#39;Teenhome&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## åˆ é™¤æ•°æ®ä¸­æ”¶å…¥å’Œå¹´é¾„çš„å¼‚å¸¸å€¼éƒ¨åˆ†</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">600000</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®å¯è§†åŒ–">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## åˆ›å»ºæ–°çš„ç‰¹å¾â€Have_Childrenâ€œï¼Œæœ‰å°å­©å€¼ä¸º1ï¼Œæ²¡æœ‰å°å­©å€¼ä¸º0</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Have_Children&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Children</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ä»¥æ˜¯å¦æœ‰å°å­©ä¸ºåˆ†ç»„å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ç»˜åˆ¶æ•£ç‚¹å›¾çŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="n">pairplot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Spent&#39;</span><span class="p">,</span> <span class="s1">&#39;Recency&#39;</span><span class="p">,</span> <span class="s1">&#39;Have_Children&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">pairplot</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Have_Children&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## å¯¹è¿ç»­å‹å˜é‡Ageè¿›è¡Œé¢å…ƒåˆ’åˆ†</span>
</span></span><span class="line"><span class="cl"><span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">aged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of age_cut:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">aged</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ä¸åŒå¹´é¾„æ®µé¡¾å®¢åˆ†ç±»æ±‡æ€»</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">aged</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;countplot of Age&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ä¸åŒå¹´é¾„åŒºé—´åœ¨è´­ç‰©èŠ±è´¹ä¸Šçš„åŒºåˆ«</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">aged</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Spent&#39;</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## å—æ•™è‚²æ°´å¹³å’Œè´­ç‰©èŠ±è´¹é—´çš„å…³ç³»</span>
</span></span><span class="line"><span class="cl"><span class="c1">## ä¸åŒå©šå§»çŠ¶æ€ä¸‹é¡¾å®¢çš„èŠ±è´¹æ¯”è¾ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">to_boxplot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Marital_Status&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">to_boxplot</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Spent&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;boxplot of spent by </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ä»¥æ•™è‚²æ°´å¹³çš„ä¸åŒå¯¹ä¸åŒå©šå§»çŠ¶æ€çš„é¡¾å®¢è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¯¹æ¯”å…¶åœ¨æ”¶å…¥å’Œè´­ç‰©èŠ±è´¹ä¸Šçš„å·®å¼‚å¯¹æ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="s1">&#39;Marital_Status&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Income&#39;</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="s1">&#39;Marital_Status&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Spent&#39;</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ”¶å…¥å’Œæ”¯å‡ºå‘ˆçº¿æ€§å¢é•¿å…³ç³»</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Spent&#39;</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Spent&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Income&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ç½‘ç«™é¡¾å®¢æ•´ä½“èŠ±è´¹ç›´æ–¹å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Spent&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;histogram of Spent&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## è‡ªç”¨æˆ·ä¸Šæ¬¡è´­ä¹°ä»¥æ¥çš„å¤©æ•°çš„é¢‘æ•°åˆ†å¸ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Recency&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ç½‘ç«™ç”¨æˆ·æœˆåº¦æ´»è·ƒé¢‘æ•°ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;NumWebVisitsMonth&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Monthly activities (5-7)/month&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ç½‘ç«™æŠ•è¯‰æƒ…å†µ</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Complain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;YES&#39;</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">],</span> <span class="n">autopct</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Complain of customer&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## é…’ã€é±¼ã€æ°´æœã€é»„é‡‘ã€è‚‰ã€ç³–æœå„è‡ªé”€é‡é¢‘æ•°ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl"><span class="n">to_histplot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MntWines&#39;</span><span class="p">,</span> <span class="s1">&#39;MntFishProducts&#39;</span><span class="p">,</span> <span class="s1">&#39;MntFruits&#39;</span><span class="p">,</span> <span class="s1">&#39;MntGoldProds&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">               <span class="s1">&#39;MntMeatProducts&#39;</span><span class="p">,</span> <span class="s1">&#39;MntSweetProducts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">to_histplot</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;histogram of </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## é€šè¿‡ç›®å½•ã€å•†åº—å’Œç½‘ç«™ä¸‰ä¸ªæ¸ é“è´­ä¹°çš„é¢‘æ•°ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl"><span class="n">to_histplot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NumCatalogPurchases&#39;</span><span class="p">,</span> <span class="s1">&#39;NumStorePurchases&#39;</span><span class="p">,</span> <span class="s1">&#39;NumWebPurchases&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">to_histplot</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## åˆ›å»ºæ€»æ´»åŠ¨æ¥å—æŠ¥ä»·æ¬¡æ•°æŒ‡æ ‡</span>
</span></span><span class="line"><span class="cl"><span class="n">acceptedConcat</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;AcceptedCmp1&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp2&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp3&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp4&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp5&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">acceptedConcat</span> <span class="o">=</span> <span class="n">acceptedConcat</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;acceptedConcat:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">acceptedConcat</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ¯æ¬¡æ¥å—æ´»åŠ¨æŠ¥ä»·çš„ç”¨æˆ·çš„é¢‘æ•°ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;accepted the campaings in every attempt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">acceptedConcat</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">acceptedConcat</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ç”¨æˆ·ä¸Šæ¬¡è´­ä¹°ä»¥æ¥çš„å¤©æ•°å’Œåœ¨ä¸Šæ¬¡æ´»åŠ¨æ˜¯å¦æ¥å—æŠ¥ä»·é—´çš„å…³ç³»</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recency Vs Acceptance of an offer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Recency&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Response&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ç½‘ç«™æ¯æœˆæ´»è·ƒç”¨æˆ·æŠ˜çº¿å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">groupedDate</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Customer NumWebVisitsMonth by mounths&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span><span class="o">.</span><span class="n">NumWebVisitsMonth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ¯æœˆæ€»ä½“æ¶ˆè´¹é‡‘é¢æŠ˜çº¿å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">groupedDate</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Customer Spent by mounths&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span><span class="o">.</span><span class="n">Spent</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ¯æœˆé€šè¿‡ç½‘ç«™è´­ä¹°çš„ç”¨æˆ·æŠ˜çº¿å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">groupedDate</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Customer NumWebPurchases by mounths&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span><span class="o">.</span><span class="n">NumWebPurchases</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ¯æœˆé€šè¿‡ç›®å½•è´­ä¹°çš„ç”¨æˆ·æŠ˜çº¿å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">groupedDate</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Customer NumCatalogPurchases by mounths&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span><span class="o">.</span><span class="n">NumCatalogPurchases</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##æ¯æœˆé€šè¿‡å•†åº—è´­ä¹°çš„ç”¨æˆ·æŠ˜ç°å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Dt_Customer&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span> <span class="o">=</span> <span class="n">groupedDate</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Customer NumStorePurchases by mounths&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">groupedDate</span><span class="o">.</span><span class="n">NumStorePurchases</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>è‡ª2014å¹´6æœˆä»½ä»¥æ¥ç½‘ç«™çš„ç½‘ç«™è®¿é—®æ¬¡æ•°å’Œäº¤æ˜“æ€»é‡å‡ºç°äº†å¤§å¹…çš„ä¸‹æ»‘ã€‚é€šè¿‡ç½‘ç«™ã€ç›®å½•ã€å•†åº—ç›´æ¥è´­ä¹°çš„ä¸‰ä¸ªæ¸ é“éƒ½å‡ºç°äº†ç›¸åŒè½¨è¿¹çš„ä¸‹æ»‘ã€‚</p>
<h2 id="æ•°æ®é¢„å¤„ç†-1">æ•°æ®é¢„å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®é¢„å¤„ç†-1">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">object_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Categorical variables in the dataset:&#34;</span><span class="p">,</span> <span class="n">object_cols</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">LE</span><span class="o">=</span><span class="n">LabelEncoder</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">object_cols</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## ç›¸å…³æ€§çƒ­åŠ›å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">data1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ds</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cols_del</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp3&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp4&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp5&#39;</span><span class="p">,</span> <span class="s1">&#39;AcceptedCmp1&#39;</span><span class="p">,</span><span class="s1">&#39;AcceptedCmp2&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Complain&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">,</span> <span class="s1">&#39;Have_Children&#39;</span><span class="p">,</span> <span class="s1">&#39;Dt_Customer&#39;</span><span class="p">,</span>  <span class="s1">&#39;Children&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">cols_del</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æ•°æ®æ ‡å‡†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">scaled_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">columns</span> <span class="p">)</span>
</span></span></code></pre></div><h2 id="pcaé™ç»´">PCAé™ç»´<a hidden class="anchor" aria-hidden="true" href="#pcaé™ç»´">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_ds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">PCA_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">scaled_ds</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">([</span><span class="s2">&#34;col1&#34;</span><span class="p">,</span><span class="s2">&#34;col2&#34;</span><span class="p">,</span> <span class="s2">&#34;col3&#34;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">PCA_ds</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span><span class="n">PCA_ds</span><span class="p">[</span><span class="s2">&#34;col1&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span><span class="n">PCA_ds</span><span class="p">[</span><span class="s2">&#34;col2&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span><span class="n">PCA_ds</span><span class="p">[</span><span class="s2">&#34;col3&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## é™ç»´åæ•°æ®å¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&#34;3d&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&#34;o&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Data Visualization In The Reduced Dimension&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="èšç±»">èšç±»<a hidden class="anchor" aria-hidden="true" href="#èšç±»">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Elbow_M</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span><span class="n">KMeans</span><span class="p">(),</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Elbow_M</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">PCA_ds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Elbow_M</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">AC</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## æ‹Ÿåˆæ¨¡å‹å¹¶é¢„æµ‹èšç±»</span>
</span></span><span class="line"><span class="cl"><span class="n">yhat_AC</span> <span class="o">=</span> <span class="n">AC</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">PCA_ds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">PCA_ds</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">yhat_AC</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## å°†èšç±»ç‰¹å¾æ·»åŠ åˆ°åŸå§‹æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">]</span><span class="o">=</span> <span class="n">yhat_AC</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## èšç±»ç»“æœå¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;bla&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">PCA_ds</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Set2&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;The Plot Of The Clusters&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="è¯„ä¼°æ¨¡å‹">è¯„ä¼°æ¨¡å‹<a hidden class="anchor" aria-hidden="true" href="#è¯„ä¼°æ¨¡å‹">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## èšç±»ç»“æœåˆ†å¸ƒå›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span> <span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Distribution Of The Clusters&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æŒ‰ç…§æ”¶å…¥å’Œæ”¯å‡ºå¯¹èšç±»ç»“æœè¿›è¡Œå¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Spent&#34;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Income&#34;</span><span class="p">],</span><span class="n">hue</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span> <span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Cluster&#39;s Profile Based On Income And Spent&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>æ”¶å…¥ä¸æ”¯å‡ºå›¾æ˜¾ç¤ºé›†ç¾¤æ¨¡å¼</strong></p>
<ul>
<li>ç¬¬ 0 ç»„ï¼šé«˜æ”¯å‡ºå’Œå¹³å‡æ”¶å…¥</li>
<li>ç¬¬ 1 ç»„ï¼šé«˜æ¶ˆè´¹å’Œé«˜æ”¶å…¥</li>
<li>ç¬¬ 2 ç»„ï¼šä½æ”¯å‡ºå’Œä½æ”¶å…¥</li>
<li>ç¬¬ 3 ç»„ï¼šé«˜æ”¯å‡ºå’Œä½æ”¶å…¥</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Spent&#34;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span> <span class="s1">&#39;Set2&#39;</span> <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## æŒ‰ç…§èšç±»ç»“æœå¯¹æ´»åŠ¨æ€»æ¥å—æƒ…å†µè¿›è¡Œå¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;TotalAcceptedCmp&#34;</span><span class="p">],</span><span class="n">hue</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&#34;Clusters&#34;</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span> <span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;Count Of Promotion Accepted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pl</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;Number Of Total Accepted Promotions&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://xin5835.github.io/tags/python/">Python</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://xin5835.github.io/post/%E4%BA%92%E8%81%94%E7%BD%91%E5%A4%A7%E5%8E%82%E9%BB%91%E5%8C%96190%E5%8F%A5/">
    <span class="title">Â« Prev</span>
    <br>
    <span>äº’è”ç½‘å¤§å‚é»‘åŒ–190å¥</span>
  </a>
  <a class="next" href="https://xin5835.github.io/post/%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/">
    <span class="title">Next Â»</span>
    <br>
    <span>å‰ä¸–ä»Šç”Ÿ</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://xin5835.github.io/">Robert&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
